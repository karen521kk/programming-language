# programming-language
姓名:周佑庭

作業一
# -*- coding: utf-8 -*-
"""作業一.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1BNTH5LwGlBqoa-r4w1i-xwzqATK9nLpa
"""

!pip install gspread google-auth
!pip install google-generativeai --upgrade

from google.colab import auth
auth.authenticate_user()

import gspread
from google.auth import default
creds, _ = default()

gc = gspread.authorize(creds)

import pandas as pd
sheets = gc.open_by_url('https://docs.google.com/spreadsheets/d/1Vc689UvCktZCh4ycS3ADWFC09Bp-UIdip-04BWAE1WY/edit?gid=1801345281#gid=1801345281')
worksheet = sheets.get_worksheet(0)
df = pd.DataFrame(worksheet.get_all_records())
df



import google.generativeai as genai
import os

api_key = 'AIzaSyA_biPJhHmybEadPeU9y5V0r3qxd2G7PHQ'
genai.configure(api_key = api_key)

model = genai.GenerativeModel('gemini-2.0-flash')
prompt = f"""以下是來自google sheets的資料;
{df.to_string(index=False)}
請依據以上資料做一個摘要
"""
response = model.generate_content(prompt)

print(response.text)

for i in range(10):
  queston=input("請輸入問題:")
  if queston == "exit":
    print("bye")
    break
  prompt = f"""以下是來自google sheets的資料;
  {df.to_string(index=False)}
  請依據以上資料回答問題:{queston}
  """
  response = model.generate_content(prompt)
  print(response.text)
